n=6
%%для10
%  A = [0.400867689637522,0.301428838541141,0.275066075340418,-0.757356783424434,1.10237615969033,0.0972382447171924,1.10022155928629,-0.600029968738298,1.22114252809720,-1.69347343820220;0.527980254093620,-0.983907200446704,-0.926744134897282,-2.63155999030566,-0.480361436070115,1.07326114248551,-0.609975333437840,-0.851796135944675,0.251117425992074,1.09644216713808;-2.51255073974032,0.253466172886285,-0.721761810229195,0.760182124323595,0.0914422869110086,0.728019457701600,-1.27601624602601,0.793887980773695,0.143653587048877,-0.0573844519343696;0.0242309382240210,0.787968431973862,0.440973878310464,1.87485025965281,-1.33314859933239,-2.44887073997921,-0.416266216300247,-0.108929835309194,1.35064001784588,0.191892757098453;2.09556009097523,-0.593295928033815,1.09289452575702,0.499640559375288,-0.183064924833343,-1.79156662597488,-0.684967419085636,-1.55281304993989,0.159095144870181,1.28127232781409;-0.188436552704598,0.492203740278357,0.170103060198088,1.37632305174892,-1.62586680923160,-0.833355645073735,0.262160541284486,2.17079436434579,-1.72228485274529,0.402756838819793;-0.644192125333795,0.565484671871824,1.30484977907667,0.0589804263138338,-0.702423537820034,-0.873608478277599,-0.231285740218748,-0.341696157904287,-0.0160597778383049,-3.72221124717879;-1.00776657454445,-0.0428055411041498,-0.930131302077910,-1.23041959439789,0.759492251507459,-1.60023063319023,-1.48551690852453,0.271057853623039,1.16699341417207,-1.66373637346808;-1.81095975663955,1.95644851692360,0.338158085170626,-0.872471723196591,1.70965349866808,-0.678253651412755,0.580323167621411,0.354827130769866,1.21263283695454,-0.828008532283755;-0.489439999192030,-1.27220219234749,-0.530893929720622,-0.802665909121839,0.485441157199326,-0.931176506955660,-0.363951370950101,-1.30652577119121,0.264676010233223,-1.29129304644097];
B =rand(n,n)
%%для6 несеметрич
% A = [-1.72046870082285,-0.840848006262920,0.136059626849985,1.12596010948328,-1.49164980783487,-0.666654171832666;0.198754840450701,-0.0266104816740556,-0.542969960862893,-1.49109570625847,-1.09866949938325,0.738423128069416;1.60430658415309,0.262225204747552,0.189833529991879,1.29936401163752,0.200056167886774,0.894381149570428;-1.18456881712455,1.09948308991036,-1.76814421953103,-1.66413480558299,0.961091252946386,0.0782103389231284;1.01072120165614,1.09534226685426,0.526076301075762,1.26816370406909,-0.772756154279721,1.45081882824035;1.37739457118937,0.128533783916308,2.30392294101240,0.0556176629818286,-1.12638295737470,-0.119655803484486] 
s='asd'
%%%%%%%%%%%%%%%%%%% плохо определенные корни
% B = [-1.72046870082285,-0.840848006262920,0.136059626849985,1.12596010948328,-1.49164980783487,-0.666654171832666;0.198754840450701,-0.0266104816740556,-0.542969960862893,-1.49109570625847,-1.09866949938325,0.738423128069416;1.60430658415309,0.262225204747552,0.189833529991879,1.29936401163752,0.200056167886774,0.894381149570428;-1.18456881712455,1.09948308991036,-1.76814421953103,-1.66413480558299,0.961091252946386,0.0782103389231284;1.01072120165614,1.09534226685426,0.526076301075762,1.26816370406909,-0.772756154279721,1.45081882824035;1.37739457118937,0.128533783916308,2.30392294101240,0.0556176629818286,-1.12638295737470,-0.119655803484486] 
[Q,r]=qr(B);
d=[1:n];
D=diag(d);
A=Q.'*D*Q
s='asd'

%%%%%%%%%%%%%%%%%%%%%%%%%%% симетр
% A = [-1.72046870082285,-0.840848006262920,0.136059626849985,1.12596010948328,-1.49164980783487,-0.666654171832666;0.198754840450701,-0.0266104816740556,-0.542969960862893,-1.49109570625847,-1.09866949938325,0.738423128069416;1.60430658415309,0.262225204747552,0.189833529991879,1.29936401163752,0.200056167886774,0.894381149570428;-1.18456881712455,1.09948308991036,-1.76814421953103,-1.66413480558299,0.961091252946386,0.0782103389231284;1.01072120165614,1.09534226685426,0.526076301075762,1.26816370406909,-0.772756154279721,1.45081882824035;1.37739457118937,0.128533783916308,2.30392294101240,0.0556176629818286,-1.12638295737470,-0.119655803484486] 
% A=(A+A')*1/2
% s='sim'
S=[]
% binpow(A,n,S)
Ai=1
for i=1:n
    Ai=Ai*A
    S=[S,-trace(Ai)]
end
p=ones(1,n+1);
p(2)=S(1)
for k=3:n+1
    g=0
    for i=2:k-1
       g=g+p(i)*S(k-i) 
    end
    p(k)=(1/(k-1))*(S(k-1)+g)
end
R1=roots(p)
I=imag(R1)
R=[]
o=1
for i=1:length(R1)
    if I(i)==0
        R(o)=R1(i) 
        o=o+1
    end
end
L_g=[]
R_g=[]
for i=1:length(R)
    R_g(i)=R(i)+0.002
    L_g(i)=R(i)-0.002
end

syms x y;
f=p(n+1)
for i=1:n
f=f+p(n+1-i)*x^i
end
p
f

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

X=[]
for i=1:length(R)
    a=L_g(i)
    b=R_g(i)
    eps=10^(-5);
    n_iter=0;
    fun_d=diff(f);
    fun_d2=diff(fun_d);
    fun=inline(f);
    f_d=inline(fun_d);
    f_d2=inline(fun_d2);
    Y=fun(X);
    Y_d=f_d(X);
    Y_d_2=f_d2(X);
    x0=b;
    m=1
    stap=10^(-7);
    while fun(x0)*f_d2(x0)<=0 
        x0=x0-stap;
    end
    xi=x0;
    xi_1=0;
    k=0;
    disp("корень есть на ["+a+","+b+"]")
    if ((Y_d>0) | (Y_d*-1>0))
        disp("первая производная знакопостяонна на ["+a+","+b+"]")
        if ((Y_d_2>0) | (Y_d_2*-1>0))
            disp("вторая производная знакопостяонна на ["+a+","+b+"]")
    while abs(xi-xi_1)>=eps || k==100
        k=k+1;
        xi_1=xi;
        xi=xi-m*(fun(xi)/f_d(xi));
        if k>1000
            break
        end
    end
    disp(k)
        end
    end
    X(i)=xi
end

figure
hold on
x = -10:0.05:35;
if s=='sim'
    axis([-3, 2, -0.6, 0.4])
else
    axis([0, 12, -1, 1])
end
plot(x, double(subs(f, x)))
title('метод')
plot(X,0, '*')

syms x;
ff=det(A-x*eye(n))
GGGG=roots(poly(A))
figure
title('матлаб')
hold on
x6 = -10:0.05:35;
axis([-0, 11, -1, 1])
plot(x6, double(subs(ff, x6)))
plot(GGGG,0,'o')

function R=binpow (a, n) 
    
	if n == 0
		R= 1; 
	elseif mod(n, 2) == 1
		R= binpow (a, n-1) * a;
	else 
		R= binpow(a, n/2) * binpow(a, n/2);
    end
end





