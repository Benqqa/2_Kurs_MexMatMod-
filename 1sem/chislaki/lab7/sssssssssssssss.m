n=10

A=randn(n,n)

% d = [n:-1:1];
d = [(n-1)+0.0001,n-1:-1:1];
[Q,R]=qr(A);
D=diag(d);
A=Q*D*Q'
A=newAA(n,d);
A_ist=A;
%%не отделимые
% A_ist=[5.51824022322552,-0.650484007446300,0.892025304814470,-0.161076646534553,1.55038499481265,0.644463213631160,-0.178635252658225,0.862475325630966,0.229447996717543,1.92456495982636;-0.650484007446300,4.92099965005013,-0.0480536655734751,-0.301626443236896,0.756563499773313,-0.530146755801304,1.97201089630657,0.307255054944670,0.00782133442739963,1.37399353239355;0.892025304814470,-0.0480536655734751,5.88051268983808,0.537679086261230,0.761048417042400,0.636812685737989,-0.329866740123142,1.68034648787646,-0.399197219503724,-0.689925661596744;-0.161076646534553,-0.301626443236896,0.537679086261230,6.19527150263393,1.13718853734319,-1.24365072575797,1.02222479772974,1.12160027114064,0.225370442401033,-0.256110864138884;1.55038499481265,0.756563499773313,0.761048417042400,1.13718853734319,5.11809555218820,-1.10376711891751,1.03125281475627,-0.226062628374634,-0.973940939367273,-0.221012773072092;0.644463213631160,-0.530146755801304,0.636812685737990,-1.24365072575797,-1.10376711891751,6.83057057373752,0.605029790413363,1.08425333986714,0.315326305092823,0.358437644528635;-0.178635252658225,1.97201089630657,-0.329866740123142,1.02222479772974,1.03125281475627,0.605029790413363,4.62027029543432,0.197036104026662,1.10400194778297,-0.706553770837297;0.862475325630966,0.307255054944670,1.68034648787646,1.12160027114064,-0.226062628374634,1.08425333986714,0.197036104026661,4.63125124324226,-0.0146606370570403,0.211645069579626;0.229447996717543,0.00782133442739966,-0.399197219503724,0.225370442401033,-0.973940939367273,0.315326305092823,1.10400194778297,-0.0146606370570403,4.76239243332309,1.53531095577176;1.92456495982636,1.37399353239355,-0.689925661596744,-0.256110864138884,-0.221012773072092,0.358437644528635,-0.706553770837297,0.211645069579626,1.53531095577176,5.52249583632695]
%%отделимые
% A_ist=[6.12677129949628,1.87018809952753,0.484339274607812,-0.175351191195832,0.0173938977794479,0.890417767460069,0.568127171788682,-1.46444632923224,1.57077921150157,-0.164816352991361;1.87018809952753,4.48929489910100,0.0606116901786502,-0.744547510993665,0.249531795398726,0.379046089047322,0.916963264428250,0.868964324464598,1.17523332441594,1.90347870205350;0.484339274607812,0.0606116901786502,5.90099180808329,0.738000719614422,0.147980915495350,1.64126276738541,-0.0799794392518379,-0.196584727208199,-0.704312008468729,1.27535518358561;-0.175351191195832,-0.744547510993664,0.738000719614422,4.59956354988255,-0.218121075457876,-0.281134789254060,-0.668129840941757,1.21786164789809,2.10980615748692,0.811396074651395;0.0173938977794479,0.249531795398726,0.147980915495350,-0.218121075457876,4.42828342381294,-0.204265967689604,0.878904767939053,0.715179927114713,-0.320862832589088,0.715223934376731;0.890417767460069,0.379046089047323,1.64126276738541,-0.281134789254060,-0.204265967689604,5.58261751231080,0.811507738001356,0.881650754839458,-1.09072532323883,0.391244233923150;0.568127171788682,0.916963264428251,-0.0799794392518379,-0.668129840941757,0.878904767939053,0.811507738001356,6.63001826539105,0.415055586782321,1.30216373515408,0.0262814337811204;-1.46444632923224,0.868964324464598,-0.196584727208199,1.21786164789809,0.715179927114713,0.881650754839458,0.415055586782320,6.17003824920128,0.255995288392844,1.29695980615774;1.57077921150157,1.17523332441594,-0.704312008468729,2.10980615748691,-0.320862832589088,-1.09072532323883,1.30216373515408,0.255995288392843,4.86251018204811,-0.591745707126770;-0.164816352991361,1.90347870205350,1.27535518358561,0.811396074651395,0.715223934376731,0.391244233923150,0.0262814337811206,1.29695980615774,-0.591745707126770,6.20991081067268]
% A_ist=[12.8313398706136,5.07558025737724,1.94153607727703,6.96193094044007,2.69860640077896,7.80236892551030,5.00524605711699,8.22699312003473,9.12792226414465,2.29860410008702;8.57160725512937,8.19613159648178,-3.05476752447438,-0.638965435319541,2.67870154934285,5.34920829283783,2.72928387184293,1.72784065730638,8.31390426909775,-3.26670072777348;10.5148956273745,6.12193625945922,7.21223501903299,5.55045261960869,9.20680763975849,9.23114440072230,2.96954453424968,9.50899662402518,5.33765066634794,4.00511521944365;9.45114229990008,-2.67232725521636,-9.00567414460712,-5.39162196349174,2.54845398297497,-5.50429519590736,-4.35458018500512,-10.8315806226039,5.17065099850708,-5.03341154475615;-5.15456526155386,-7.80719833812774,-8.29566304690725,-13.7740427878787,2.08742842788984,-12.3694039480370,-7.73900112123904,-14.1337925765974,-6.75445065186344,-7.64703088639993;-6.21076972159965,1.16280611977176,5.10630717254977,4.50805780596399,-2.98703866874465,6.10400013804802,2.67860590908823,3.89368555387419,-3.40352740370920,2.84432816845418;-3.67010591900626,-0.862332309922552,3.29624073952821,1.09046401470000,-1.68860308430631,-0.713124964841318,7.05721639169024,-2.15673199423202,-2.58262924846750,1.47845517484381;-0.988383170827544,1.31195934597799,2.12159117653199,3.95172447268335,-0.666090601861913,2.73648972859098,0.372458674063947,9.71004561745847,0.113939341284582,1.93958654016045;-4.44211048785465,-2.90989736644254,-2.11229047698406,-3.56455007287174,-0.933212490775611,-4.74657007071399,-4.32873328299833,-2.92087171801603,-1.31672176787610,-1.20242225193216;-17.8845748994547,-3.49109616625743,7.71294401320651,5.33199747479508,-8.94864988047947,-3.91964288252013,0.522559819502913,1.13891708795858,-10.7532729326777,8.50994667015284]
% A_ist=[588.039238310467,603.278528428542,358.467981479760,683.924597064169,158.840386577349,524.271904876780,352.292546002619,805.239653046463,389.821461532685,966.558466182191;-217.227598225659,-217.496033031204,-134.160717252582,-256.377229658177,-63.2376852895833,-198.426781949673,-129.919824551365,-300.114933721385,-148.541529882995,-361.616407540393;223.912561719739,231.204726562438,143.986298231926,265.646046743159,61.4261607405957,203.012254691714,132.581490246196,311.910137426056,150.072601995803,373.267326850419;889.753397681335,922.057701061447,546.737024858211,1045.18894763408,225.334341557664,795.570061477020,528.136828808711,1225.61319365213,581.829217245045,1473.37441719625;478.479039345465,495.859610404442,293.475597753675,557.223112343483,126.476319055721,425.762217004293,285.731254867076,657.624088637296,313.149208949452,789.192596548021;550.670198539907,569.305159406446,337.537464618856,643.013240879823,139.252306782397,498.412643234736,325.733814943055,757.141435994276,359.826368761707,912.419175840784;474.850223997101,490.037027080080,290.889010521715,556.774594874991,125.316927211186,425.430915589700,286.833362185121,653.949698857349,314.488262998716,785.862136781411;-455.763740800916,-472.050020714420,-279.327144565148,-530.745325463998,-113.918331588872,-408.302242593251,-270.610408011228,-620.470406009247,-297.652386114114,-753.595944223259;-1237.10275573909,-1280.54077554260,-759.327626873723,-1449.98290748802,-319.098322942020,-1106.56899590122,-735.909652303892,-1706.99108806514,-808.185106660304,-2049.63372545554;-600.490537353546,-622.893389089470,-369.539634040220,-701.962773648992,-155.961855063592,-537.592302159269,-358.057586005645,-828.398159551014,-394.878067253608,-988.785162951299]
figure
% A_ist=[5.67263241276245,-0.499098675655450,0.0605890274694188,0.776069854460435,-0.458742823383058,0.885062250519134,2.21223305634525,-0.0678649933151133,-0.905986856849863,0.778774412230193;-0.499098675655450,5.60892579933582,0.589294346978338,1.64165160060488,-0.0446072118253389,1.00394112716305,-0.519242902232729,-0.0127087329302145,-0.292725803818534,0.853068026194220;0.0605890274694188,0.589294346978338,5.08431114906221,0.501365796027897,1.34394479072281,0.385761835788674,0.426360378372134,2.35823396464137,-0.00125503095447078,1.55269908236060;0.776069854460435,1.64165160060488,0.501365796027897,4.80558970180362,0.506499436677641,0.536728238256067,1.04856012757138,-0.924210140888641,-0.652075591232823,0.173001428222008;-0.458742823383058,-0.0446072118253389,1.34394479072281,0.506499436677641,5.44446277550247,-0.303925742207883,1.27411079120611,-0.0645468647839942,1.21016226700593,1.28531763340259;0.885062250519134,1.00394112716305,0.385761835788674,0.536728238256066,-0.303925742207883,5.20493928713309,-0.606461802746105,1.15940212926763,0.219649736455191,-0.385334538243852;2.21223305634525,-0.519242902232729,0.426360378372134,1.04856012757138,1.27411079120611,-0.606461802746105,6.25430180389630,0.0964303912447894,0.560503991094364,-0.227440650676882;-0.0678649933151132,-0.0127087329302145,2.35823396464137,-0.924210140888641,-0.0645468647839941,1.15940212926763,0.0964303912447895,4.61152686851871,1.22982798867332,-0.729646923924721;-0.905986856849862,-0.292725803818534,-0.00125503095447033,-0.652075591232822,1.21016226700593,0.219649736455191,0.560503991094365,1.22982798867332,7.68549663994605,1.27274175337788;0.778774412230193,0.853068026194220,1.55269908236060,0.173001428222008,1.28531763340259,-0.385334538243853,-0.227440650676881,-0.729646923924721,1.27274175337788,4.62781356203928]
LUU(A_ist,'обычная матица')

LUU(qqqqq(A_ist),'приведеная к Хессенбергу методом вращений')

legend('обычная матица','приведеная к Хессенбергу методом вращений')

function new_A=newAA(n,d)
    A=rand(n,n);
    [Q,R]=qr(A);
    D=diag(d);
    A=Q*D*Q'
    while true
        disp('ищу матрицу под условия применимости')
        if det(A)~=0
            de=1;
            for k=0:(n-1)
                M=A(1:k,1:k);
                de=de*det(M);
            end
            if de~=0
                break
            else
                A=rand(n,n);
                [Q,R]=qr(A);
                D=diag(d);
                A=Q*D*Q'
            end
        else
                [Q,R]=qr(A);
                D=diag(d);
                A=Q*D*Q'
        end
        
    end
    new_A=A;
end
function LULULU=LUU(A,tit)
Eps = [];
Iter = [];
n = length(A);
A_ist=A
for t = 3:12
    eps = 10^-t;
    k1 = 0;
    A = A_ist;
    
    while max(tril(A,-1),[],'all')>eps 
        L = eye(n);
        R = eye(n);
        for m = 1:n
            S1 = 0;
            S2 = 0;
            for j = m:n 
                for k = 1:m-1
                    S1 = S1+L(m, k)*R(k, j);
                end
                R(m, j) = A(m, j)-S1;
                S1 = 0;
            end

            for i = m+1:n
                for k = 1:m-1
                    S2 = S2+L(i, k)*R(k, m);
                end
                L(i, m) = (A(i, m)-S2)/R(m,m);
                S2=0;
            end
        end 
        if max(diag(A,-1))<eps 
            break
        end
        A = R*L;
        k1 = k1+1;
    end
    Eps = [Eps, eps];
    Iter = [Iter,k1];
end
A
semilogx(Eps,Iter)
hold on
grid on


end